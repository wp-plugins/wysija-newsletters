jQuery(function(d){function c(){d(".form-valid-sub input.defaultlabels").each(function(f){if(a(d(this).val())==d(this).attr("defaultValue")){d(this).val("")}});if(d(this).validationEngine("validate")){wysijaAJAX.task="save";wysijaAJAX.controller="subscribers";var e=d(this).serializeArray();d.each(e,function(f,g){wysijaAJAX["data["+f+"][name]"]=g.name;wysijaAJAX["data["+f+"][value]"]=g.value});wysijaAJAX.formid=d(this).attr("id");jQuery.WYSIJA_SEND()}else{d(".form-valid-sub input.defaultlabels").each(function(f){if(d(this).val()==""){d(this).val(d(this).attr("defaultValue"))}})}return false}d(document).ready(function(){b(".form-valid-sub");d(".iframe-wysija").load(function(){elementForm=d(this).contents().find(".wysija-frame");if(elementForm.hasClass("iframe-hidden")){d(this).hide();response=elementForm.html();d(this).before('<div id="'+d(this).attr("id")+'-iframe">'+response+"</div>")}b("#"+d(this).attr("id")+"-iframe .form-valid-sub")})});function b(e){d(e).validationEngine("attach",{promptPosition:"centerRight",scroll:false,validationEventTrigger:"submit"});d(e).submit(c);d(e+"input.wysija-email").blur(function(){d(this).val(a(d(this).val()))});d(e+" input.defaultlabels").each(function(f){var g=d(this).val();d(this).attr("defaultValue",g);d(this).blur(function(){if(a(d(this).val())==""){d(this).val(g)}else{d(this).val(a(d(this).val()))}});d(this).focus(function(){if(a(d(this).val())==g){d(this).val("")}})})}function a(e){return e.replace(/^\s+/g,"").replace(/\s+$/g,"")}jQuery.WYSIJA_SEND=function(){d("#msg-"+wysijaAJAX.formid).html('<div class="allmsgs"><blink>'+wysijaAJAX.loadingTrans+"</blink></div>");d("#"+wysijaAJAX.formid).fadeOut();wysijaAJAX._wpnonce=d("#wysijax").val();d.ajax({type:"POST",url:wysijaAJAX.ajaxurl,data:wysijaAJAX,success:function(e){d("#msg-"+wysijaAJAX.formid).html('<div class="allmsgs"></div>');if(e.result){d("#msg-"+wysijaAJAX.formid+" .allmsgs").html('<div class="updated">'+d("#"+wysijaAJAX.formid+' input[name="message_success"]').val()+"</div>")}else{d("#"+wysijaAJAX.formid).fadeIn();d.each(e.msgs,function(g,f){if(!d("#msg-"+wysijaAJAX.formid+" .allmsgs ."+g+" ul").length){d("#msg-"+wysijaAJAX.formid+" .allmsgs").append('<div class="'+g+'"><ul></ul></div>')}d.each(f,function(h,i){d("#msg-"+wysijaAJAX.formid+" .allmsgs ."+g+" ul").append("<li>"+i+"</li>")})})}},error:function(e,g,f){d("#msg-"+wysijaAJAX.formid).html('<div class="allmsgs"></div>');d("#msg-"+wysijaAJAX.formid+" .allmsgs").html('<div class="error"><ul><li>textStatus:'+g+"</li><li>errorThrown:"+f+"</li><li>responseText:"+e.responseText+"</li></ul></div>")},dataType:"json"})};jQuery(".showerrors").live("click",function(){jQuery(".xdetailed-errors").toggle()});jQuery(".shownotices").live("click",function(){jQuery(".xdetailed-updated").toggle()})});